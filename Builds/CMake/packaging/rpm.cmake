cmake_policy(SET CMP0057 NEW)
set(CPACK_GENERATOR "RPM")
set(CPACK_RPM_PACKAGE_DEBUG ON)

set(CPACK_SYSTEM_NAME "x86_64")
set(CPACK_RPM_INSTALL_WITH_EXEC ON)
set(CPACK_RPM_BUILD_SOURCE_DIRS_PREFIX /src_dir)
set(CPACK_RPM_DEBUGINFO_PACKAGE ON)
set(CPACK_RPM_PACKAGE_DEBUG ON)
set(CPACK_BUILD_SOURCE_DIRS ${CMAKE_SOURCE_DIR}/src/xbwd)
set(CPACK_RPM_PACKAGE_RELEASE_DIST "el7")
set(RIPPLED_VERSION ${CPACK_PACKAGE_VERSION})
string(REPLACE "-" ";" VERSION_LIST ${CPACK_PACKAGE_VERSION})
list(GET VERSION_LIST 0 CPACK_RPM_PACKAGE_VERSION)

message("CPACK_RPM_PACKAGE_VERSION ${CPACK_RPM_PACKAGE_VERSION}")
message("VERSION_LIST ${VERSION_LIST}")
list (LENGTH VERSION_LIST _len)
if (${_len} GREATER 1)
    list(GET VERSION_LIST 1 PRE_VERSION)
    message("PRE_VERSION: ${PRE_VERSION}")
    set(CPACK_RPM_PACKAGE_RELEASE "0.1${CPACK_RPM_PACKAGE_RELEASE}.${PRE_VERSION}")
else()
    set(CPACK_RPM_PACKAGE_RELEASE "1${CPACK_RPM_PACKAGE_RELEASE}")
    set(CPACK_RPM_FILE_NAME RPM-DEFAULT)
endif()
